<div class="max-w-6xl mx-auto">
  <h1 class="text-2xl font-semibold text-white mb-2">Pipeline</h1>
  <p class="text-slate-400 text-sm mb-6">Leads by stage. Move leads through New → Contacted → Qualified → Won.</p>

  <div class="flex flex-wrap gap-2 mb-6">
    <% (lead_statuses || []).forEach(function(s) { %>
    <a href="/pipeline?status=<%= s %>" class="px-4 py-2 rounded-lg border text-sm font-medium <%= current_status === s ? 'bg-slate-700 border-cyan-500 text-white' : 'bg-slate-800/60 border-slate-600 text-slate-300 hover:border-slate-500 hover:text-white' %>"><%= s %></a>
    <% }); %>
  </div>

  <div class="bg-slate-800/60 border border-slate-700 rounded-xl overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full text-left">
        <thead class="bg-slate-700/50 text-slate-300 text-sm">
          <tr>
            <th class="px-4 py-3 font-medium">Practice</th>
            <th class="px-4 py-3 font-medium">Contact</th>
            <th class="px-4 py-3 font-medium">Status</th>
            <th class="px-4 py-3 font-medium"></th>
          </tr>
        </thead>
        <tbody class="text-slate-200">
          <% (leads || []).forEach(function(l) { var p = l.practice; %>
          <tr class="border-t border-slate-700 hover:bg-slate-700/30">
            <td class="px-4 py-3">
              <a href="/practices/<%= p && p.id ? p.id : l.practice_id %>" class="font-medium text-white hover:text-cyan-400"><%= p && p.name ? p.name : 'Practice #' + l.practice_id %></a>
            </td>
            <td class="px-4 py-3 text-sm"><%= (p && (p.contact || p.email)) ? (p.contact || p.email) : '—' %></td>
            <td class="px-4 py-3"><span class="capitalize text-slate-300"><%= l.status %></span></td>
            <td class="px-4 py-3">
              <a href="/practices/<%= p && p.id ? p.id : l.practice_id %>" class="text-cyan-400 hover:text-cyan-300 text-sm">View →</a>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
    <% if (!leads || leads.length === 0) { %>
    <p class="px-4 py-8 text-slate-400 text-center">No leads in "<%= current_status %>". Add practices from the Practices page.</p>
    <% } %>
  </div>

  <% if (pagination && pagination.pages > 1) { %>
  <div class="flex items-center justify-between mt-4">
    <p class="text-slate-400 text-sm">Page <%= pagination.page %> of <%= pagination.pages %> (<%= pagination.total %> total)</p>
    <div class="flex gap-2">
      <% if (pagination.has_prev) { %>
      <a href="/pipeline?status=<%= current_status %>&page=<%= pagination.prev_num %>" class="px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-white text-sm">Previous</a>
      <% } %>
      <% if (pagination.has_next) { %>
      <a href="/pipeline?status=<%= current_status %>&page=<%= pagination.next_num %>" class="px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-white text-sm">Next</a>
      <% } %>
    </div>
  </div>
  <% } %>
</div>
